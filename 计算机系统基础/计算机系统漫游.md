> 从Shell到屏幕输出

#####终端输入命令`./hello`，至屏幕输出`Hello World`

   ```c
   # hello.c文件
   #include <stdio.h>

   init main () {
     printf("Hello World\n")
   }
   ```

  1. 输入`gcc -o hello hello.c`，C语言 => 机器语言指令（可执行目标程序／文件）经历的四个阶段
    * 预处理器
    * 编译器
    * 汇编器
    * 链接器
    
  2. 计算机硬件简介和操作
    * 总线：携带信息字节（单位为字）并在各个部件中传递（字一般为4或8个字节长，1个字节为8位，即32位或64位系统的由来）
    * I/O设备：鼠标、键盘、屏幕、磁盘，通过控制器或适配器与总线连接
    * 主存储器：临时存储设备，在处理器运行程序时，用来存放程序和程序处理的数据（指令）
    * 处理器（CPU）：解释或执行存储在主存储器中指令的引擎，从系统通电开始，处理器不断执行PC中的指令，执行完一条就更新PC，不断重复
      * 程序计数器（PC）：一个字长的存储设备（或**寄存器**），指向主存中的某条机器指令
      * 执行指令操作的构成：**寄存器**文件（register file）和算数／逻辑单元（ALU），**寄存器**文件由一些一个字长的**寄存器**组成，用来保存从主存获取的指令，然后交由ALU进行算术逻辑操作，由处理器不断重复执行程序中的所有指令，最终完成程序执行

  3. 运行`hello`程序，计算机硬件发生了什么
    * 在shell程序（终端）中，敲入`./hello`时，shell程序将其逐一读入处理器中的寄存器中，再把它放入存储器中
    * 当敲击回车后，shell程序才知道此命令结束，然后shell程序开始加载hello可执行目标文件，将其代码和数据从磁盘复制到主存，然后从主存复制到寄存器文件，再从寄存器文件到屏幕



>操作系统管理硬件

当shell程序加载和运行hello程序时，并没有直接访问系统中的硬件（处理器，主存，I/O），而是依靠操作系统提供的服务。

1. 认识操作系统
  * 定位：操作系统使得程序能够操作硬件设备成为了可能
  * 操作系统的功能
    * 防止硬件被失控的程序滥用
    * 向程序提供简单一致的机制来操作硬件设备
  * 操作系统中的一些抽象概念
    * 文件：对I/O设备的抽象
    * 虚拟存储器：对主存和I/O设备的抽象
      
    * 进程：对处理器、主存和I/O设备的抽象，是**操作系统对一个正在运行的程序的一种抽象**。
      在一个系统上，可以同时运行多个进程（eg：多个终端窗口），当一个进程的指令与另一个进程的指令交错执行时，便产生了**并发运行**，这是通过处理器在进程中不断切换实现的，而操纵系统实现的方式则称为**上下文切换**
      此例中是shell程序和hello程序并发运行，当敲下回车后，shell程序进行系统调用，将控制权传递给操作系统，操作系统保存shell进程的上下文，创建一个新的hello进程及上下文，然后将控制权传递给hello进程，当hello进程完毕后，操作系统恢复shell进程的上下文，并将控制器转交给shell进程，等待下一个命令行输入。
    * 线程：一个进程实际上可以由多个线程的执行单元组成，每个线程都运行在进程的上下文中，共享代码及数据
      

